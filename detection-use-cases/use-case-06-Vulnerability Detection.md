## UC6 – Vulnerability Detection (Ubuntu Agent)

### Objective
Detect known vulnerabilities on an Ubuntu Linux system using Wazuh vulnerability detection. This use case demonstrates how SOC teams identify unpatched software and assess security risks before vulnerabilities can be exploited by attackers.

---

### Environment
- **Monitored Host:** Ubuntu Linux (Wazuh Agent)
- **SIEM Platform:** Wazuh
- **Detection Type:** Host-based (Package Inventory)
- **Vulnerability Source:** CVE databases integrated with Wazuh

---

### SOC Context
Unpatched Linux systems are frequently targeted by attackers for privilege escalation and service exploitation. Vulnerability detection allows SOC teams to proactively identify security weaknesses and reduce the attack surface before active exploitation occurs.

---

### Step 1: Vulnerability Detection Configuration
- Wazuh vulnerability detection module is enabled on the manager.
- The Ubuntu agent collects installed package inventory.
- Wazuh correlates installed package versions with known CVEs.
- Vulnerability feeds are updated regularly.

---

### Step 2: Vulnerability Identification
- Wazuh scans installed packages on the Ubuntu system.
- Detected vulnerabilities are matched against known CVEs.
- Vulnerability alerts are generated for affected packages.

---

### Step 3: Detection and Alert Generation
- Wazuh generates alerts containing:
  - Affected host
  - Vulnerable package name
  - CVE ID
  - Severity level (CVSS-based)
  - Installed version and fixed version (if available)
- Alerts are forwarded to the Wazuh Dashboard for SOC review.

---

### Step 4: Alert Visibility
- Vulnerability alerts are visible in the Wazuh Dashboard.
- SOC analysts can filter vulnerabilities by severity and package.
- High and critical vulnerabilities are prioritized for investigation.

---

### Step 5: SOC Investigation
The SOC analyst investigates:
- **Which system is affected:** Ubuntu Agent
- **What is vulnerable:** Package name and version
- **Risk level:** CVSS score and severity
- **Exposure:** Whether the vulnerable service is running or externally accessible
- **Correlation:** Any related suspicious activity or exploitation attempts

---

### Response Actions (Simulated)
- Vulnerability findings are documented and reported to system owners.
- Package updates or patches are recommended.
- Temporary mitigation steps are suggested if patching is delayed.
- The system is monitored for exploitation attempts.

---

### Evidence to Collect
- Screenshot of vulnerability alert in Wazuh Dashboard
- CVE ID and severity score
- Vulnerable package name and version
- Hostname and operating system details

---

### MITRE ATT&CK Mapping
- **TA0001 – Initial Access**
- **T1190 – Exploit Public-Facing Application**
- **T1068 – Exploitation for Privilege Escalation**

---

### SOC Relevance
This use case demonstrates the SOC’s ability to identify vulnerable Ubuntu systems, prioritize remediation, and reduce the risk of exploitation through proactive vulnerability management.
